<!-- Bootstrap v3.0.3 -->
<link href="https://s3.amazonaws.com/mturk-public/bs30/css/bootstrap.min.css" rel="stylesheet" />
<section class="container" style="padding: 10px 10px; font-family: Verdana, Geneva, sans-serif; color:#333333; font-size:0.9em;">
<div class="row col-md-12"><!-- Instructions -->
<div class="panel panel-primary">
<div class="panel-heading"><strong>Instructions</strong></div>

<div class="panel-body"><b>STEP 1:</b> Highlight as many TERMS from the QUESTION and the PASSAGE that match each other in meaning. You can IGNORE STOP WORDS (the, of, but, etc) and IGNORE SPELLING MISTAKES.<br />
<br />
An example result of matching terms and their relation types:<br />
&nbsp;
<div id="example">
<fieldset><legend>EXAMPLE QUESTION:</legend>

<div class="passage"><span class="word">Do</span><span class="term rel0term"><span class="exampleRel" style="border-bottom: 6px solid #8dd3c7; width: 423px; position: absolute; z-index: 3; top: 60px; left: 50px; -webkit-transform: rotate(0.2851rad); transform:rotate(0.2851rad); -ms-transform:rotate(0.2851rad);">is identical to</span><span class="word">isotopes</span></span><span class="word">of</span><span class="word">the</span><span class="term rel3term"><span class="term rel2term"><span class="term rel1term"><span class="word">same</span></span></span><span class="word">element</span></span><span class="word">have</span><span class="word">the</span><span class="term rel4term"><span class="word">same</span><span class="term rel5term"><span class="word">atonic</span><span class="word">weight?</span></span></span></div>
</fieldset>

<hr />
<fieldset><legend>EXAMPLE PASSAGE:</legend>

<div class="passage"><span class="term rel3term"><span class="exampleRel" style="border-bottom: 6px solid #fb8072; width: 196.2px; position: absolute; z-index: 3; top: -60px; left: 65px; -webkit-transform: rotate(-0.55rad);transform:rotate(-0.55rad);-ms-transform:rotate(-0.55rad);">paraphrases</span><span class="term rel1term"><span class="exampleRel" style="border-bottom: 6px solid #ffffb3; width: 199px; position: absolute; z-index: 3; top: -58px; left: 0px; -webkit-transform: rotate(-0.55rad); transform:rotate(-0.55rad);-ms-transform:rotate(-0.55rad);">is a synonym of</span><span class="word">Similar</span></span><span class="word">elements</span></span><span class="word">with</span><span class="term rel4term"><span class="exampleRel" style="border-bottom: 6px solid #80b1d3; width: 203.8px; position: absolute; z-index: 3; top: -60px; left: 35px; -webkit-transform: rotate(-0.5rad);transform:rotate(-0.5rad);-ms-transform:rotate(-0.5rad);">overlaps with</span><span class="term rel2term"><span class="exampleRel" style="border-bottom: 6px solid #bebada; width: 110px; position: absolute; z-index: 3; top: -47px; left: -10px; -webkit-transform: rotate(1.4rad);transform:rotate(1.4rad);-ms-transform:rotate(1.4rad);">negates</span><span class="word">different</span></span><span class="term rel5term"><span class="exampleRel" style="border-bottom: 6px solid #fdb462; width: 219.5px; position: absolute; z-index: 3; top: -55px; left: 20px; -webkit-transform: rotate(-0.5rad);transform:rotate(-0.5rad);-ms-transform:rotate(-0.5rad);">generalizes</span><span class="word">atomic</span></span><span class="word">weights</span></span><span class="word">are</span><span class="word">called</span><span class="word">an</span><span class="term rel0term"><span class="word">isotope.</span></span></div>
</fieldset>
</div>
<br />
<b>STEP 2:</b> Select the MATCH TYPE for each selected pair in STEP 1:

<ul>
	<li><b>identical:</b> the two terms are identical, ignoring spelling</li>
	<li><b>synonym:</b> the two terms mean the same thing</li>
	<li><b>generalization:</b> one term is more general than the other</li>
	<li><b>paraphrase:</b> one term says the same thing as the other, but in a different way</li>
	<li><b>negation:</b> the terms match by being opposites or through negation</li>
	<li><b>overlap:</b> the terms both have two or more words and partially overlap</li>
</ul>
</div>
</div>
<!-- End Instructions --><!-- Survey Body -->

<section>
<fieldset><label class="legend">Highlight as many terms that match each other in meaning:</label>

<div class="alignment">
<fieldset><legend>QUESTION:</legend>

<div class="passage" id="passage1">{{question_text}}</div>
</fieldset>

<hr />
<fieldset><legend>PASSAGE:</legend>

<div class="passage" id="passage2">{{passage_text}}</div>
</fieldset>

<div class="lines">&nbsp;</div>
&nbsp;

<div class="relStorage"><input class="rel0a" name="rel0a" type="hidden" /><input class="rel0b" name="rel0b" type="hidden" /> <input class="rel1a" name="rel1a" type="hidden" /><input class="rel1b" name="rel1b" type="hidden" /> <input class="rel2a" name="rel2a" type="hidden" /><input class="rel2b" name="rel2b" type="hidden" /> <input class="rel3a" name="rel3a" type="hidden" /><input class="rel3b" name="rel3b" type="hidden" /> <input class="rel4a" name="rel4a" type="hidden" /><input class="rel4b" name="rel4b" type="hidden" /> <input class="rel5a" name="rel5a" type="hidden" /><input class="rel5b" name="rel5b" type="hidden" /> <input class="rel6a" name="rel6a" type="hidden" /><input class="rel6b" name="rel6b" type="hidden" /> <input class="rel7a" name="rel7a" type="hidden" /><input class="rel7b" name="rel7b" type="hidden" /> <input class="rel8a" name="rel8a" type="hidden" /><input class="rel8b" name="rel8b" type="hidden" /> <input class="rel9a" name="rel9a" type="hidden" /><input class="rel9b" name="rel9b" type="hidden" /> <input class="rel10a" name="rel10a" type="hidden" /><input class="rel10b" name="rel10b" type="hidden" /> <input class="rel11a" name="rel11a" type="hidden" /><input class="rel11b" name="rel11b" type="hidden" /> <input class="rel12a" name="rel12a" type="hidden" /><input class="rel12b" name="rel12b" type="hidden" /> <input class="rel13a" name="rel13a" type="hidden" /><input class="rel13b" name="rel13b" type="hidden" /> <input class="rel14a" name="rel14a" type="hidden" /><input class="rel14b" name="rel14b" type="hidden" /> <input class="rel15a" name="rel15a" type="hidden" /><input class="rel15b" name="rel15b" type="hidden" /> <input class="rel16a" name="rel16a" type="hidden" /><input class="rel16b" name="rel16b" type="hidden" /> <input class="rel17a" name="rel17a" type="hidden" /><input class="rel17b" name="rel17b" type="hidden" /> <input class="rel18a" name="rel18a" type="hidden" /><input class="rel18b" name="rel18b" type="hidden" /> <input class="rel19a" name="rel19a" type="hidden" /><input class="rel19b" name="rel19b" type="hidden" /> <input class="rel20a" name="rel20a" type="hidden" /><input class="rel20b" name="rel20b" type="hidden" /> <input class="rel21a" name="rel21a" type="hidden" /><input class="rel21b" name="rel21b" type="hidden" /> <input class="rel22a" name="rel22a" type="hidden" /><input class="rel22b" name="rel22b" type="hidden" /> <input class="rel23a" name="rel23a" type="hidden" /><input class="rel23b" name="rel23b" type="hidden" /> <input class="rel24a" name="rel24a" type="hidden" /><input class="rel24b" name="rel24b" type="hidden" /> <input class="rel25a" name="rel25a" type="hidden" /><input class="rel25b" name="rel25b" type="hidden" /> <input class="rel26a" name="rel26a" type="hidden" /><input class="rel26b" name="rel26b" type="hidden" /> <input class="rel27a" name="rel27a" type="hidden" /><input class="rel27b" name="rel27b" type="hidden" /> <input class="rel28a" name="rel28a" type="hidden" /><input class="rel28b" name="rel28b" type="hidden" /> <input class="rel29a" name="rel29a" type="hidden" /><input class="rel29b" name="rel29b" type="hidden" /></div>
<input id="browser" name="browser" type="hidden" value="" />
<div class="relations"><label class="legend">What is the type of the matched terms?</label>

<div class="relation rel0 secret"><select name="rel0"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel1 secret"><select name="rel1"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel2 secret"><select name="rel2"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel3 secret"><select name="rel3"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel4 secret"><select name="rel4"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel5 secret"><select name="rel5"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel6 secret"><select name="rel6"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel7 secret"><select name="rel7"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel8 secret"><select name="rel8"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel9 secret"><select name="rel9"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel10 secret"><select name="rel10"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel11 secret"><select name="rel11"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel12 secret"><select name="rel12"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel13 secret"><select name="rel13"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel14 secret"><select name="rel14"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel15 secret"><select name="rel15"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel16 secret"><select name="rel16"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel17 secret"><select name="rel17"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel18 secret"><select name="rel18"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel19 secret"><select name="rel19"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel20 secret"><select name="rel20"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel21 secret"><select name="rel21"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel22 secret"><select name="rel22"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel23 secret"><select name="rel23"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel24 secret"><select name="rel24"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel25 secret"><select name="rel25"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel26 secret"><select name="rel26"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel27 secret"><select name="rel27"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel28 secret"><select name="rel28"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="relation rel29 secret"><select name="rel29"><option value="">Select one</option><option value="ide">is identical to</option><option value="syn">is a synonym of</option><option value="gen">generalizes</option><option value="par">paraphrases</option><option value="neg">negates</option><option value="int">overlaps with</option></select><span class="remove">[x]</span></div>

<div class="instructions"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgogICAgICAgICA8ZGM6c3ViamVjdD4KICAgICAgICAgICAgPHJkZjpCYWcvPgogICAgICAgICA8L2RjOnN1YmplY3Q+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrlPw1BAAAAwUlEQVQokY2SwW3DMBAE50j/4xJSgtIBRUB/d2CXpnSQvwDKHZglpAS7AGnzCAkwQqxkXgdycFzwziRR6fv+bGYX4BU4AlnSOM/ze3VMEsMwvCzLcgU6fid778M0TQ8H8IcM0BUHCyGczWxsb1NKBhBjVHsu6XIomX+wFSvOudNhG6V2f/JC54D7f7oXjg743BG2ZCdpfBaprUuk0SQRY7yx/60AOaX05gC89wHIe3JxviddaVajA+5mltd1/WhX4wtFf1orAk7NmgAAAABJRU5ErkJggg==" /> In both the question and passage, click on a WORD or drag across a RANGE OF WORDS that you want to select. You can remove matched terms by clicking the [x].</div>
</div>
&nbsp;

<div class="notPossible"><label class="legend">Why is it NOT possible to match more terms?</label><br />
<textarea name="notpossible" required="" title="Please explain why it is NOT possible to match more terms."></textarea>

<div class="instructions"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgogICAgICAgICA8ZGM6c3ViamVjdD4KICAgICAgICAgICAgPHJkZjpCYWcvPgogICAgICAgICA8L2RjOnN1YmplY3Q+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrlPw1BAAAAwUlEQVQokY2SwW3DMBAE50j/4xJSgtIBRUB/d2CXpnSQvwDKHZglpAS7AGnzCAkwQqxkXgdycFzwziRR6fv+bGYX4BU4AlnSOM/ze3VMEsMwvCzLcgU6fid778M0TQ8H8IcM0BUHCyGczWxsb1NKBhBjVHsu6XIomX+wFSvOudNhG6V2f/JC54D7f7oXjg743BG2ZCdpfBaprUuk0SQRY7yx/60AOaX05gC89wHIe3JxviddaVajA+5mltd1/WhX4wtFf1orAk7NmgAAAABJRU5ErkJggg==" /> Note that you should IGNORE SPELLING MISTAKES in the question and passage.</div>
</div>
</div>
</fieldset>
</section>
<!-- End Survey Body --><input class="btn btn-primary" id="submitButton" type="Submit" value="Submit" /></div>
</section>
<!-- close container -->
<style type="text/css">fieldset {
    padding: 10px;
    background:#fbfbfb;
    border-radius:5px;
    margin-bottom:5px;
}
h5 { font-size: 10pt; color: #e32636; }
.alignment hr { margin-top: 22px; }
.alignment fieldset, #example fieldset { border: 1px solid #737373; padding: 10px; margin: 0px; }
.alignment legend, #example legend { border: 0px; margin: 0px; padding: 0 5px 0 5px; width: auto; font-weight: inherit; font-size: inherit; line-height: inherit; letter-spacing: inherit; }
.passage { text-align:center; }

.alignment { -moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; user-select: none;}
.alignment .passage .word:hover { cursor: pointer; cursor: hand; background-color: #C6C6C6; }

.alignment select { height: 25px; padding: 0px 6px; }
.alignment textarea { width: 95%; max-width:700px; height: 108px; }

.passage .word { position:relative; display: inline-block; line-height: 24px; z-index: 5; margin: 0px; padding: 4px 4px 5px 4px; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; }
.passage .term { position: relative; z-index: 5; margin: 0px; padding: 6px 0px 7px 0px; }

/* nested annotations are smaller than their parents */
.passage .term .term { padding: 4px 0px 5px 0px; }
.passage .term .term .term { padding: 2px 0px 3px 0px; }
.passage .term .term .term .term { padding: 0px 0px 1px 0px; }

.term { -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; -webkit-box-shadow: inset 0px 1px 1px #fff, 0 1px 0px 0px #000;
     -moz-box-shadow: inset 0px 1px 1px #fff, 0 1px 0px 0px #000;
     box-shadow: inset 0px 1px 1px #fff, 0 1px 0px 0px #000; }

#example { position: relative; }
#example .exampleRel { text-align:center; font-weight:bold; letter-spacing: 0.5px; line-height:14px; }
#example .term { padding-left:4px; padding-right:4px; }

.relation { margin-bottom: 0px; width: inherit; }
.relation .legend { display: none; }
.relation .term { margin: 0 2px 0 2px; line-height:30px; padding: 4px 4px 5px 4px; }
.secret { display: none; }

.instructions { color: #e32636; }

.remove:hover { color: #CC0000; }
.relation .remove { cursor: pointer; cursor: hand; }

.rel0term { background-color: #8dd3c7; border: 1px solid #4d9387; }
.rel1term { background-color: #ffffb3; border: 1px solid #bfbf73; }
.rel2term { background-color: #bebada; border: 1px solid #7e7a9a; }
.rel3term { background-color: #fb8072; border: 1px solid #bb4032; }
.rel4term { background-color: #80b1d3; border: 1px solid #407193; }
.rel5term { background-color: #fdb462; border: 1px solid #bd7422; }
.rel6term { background-color: #b3de69; border: 1px solid #73be29; }
.rel7term { background-color: #fccde5; border: 1px solid #bc8da5; }
.rel8term { background-color: #d9d9d9; border: 1px solid #999999; }
.rel9term { background-color: #bc80bd; border: 1px solid #7c407d; }

.rel10term { background-color: #ccebc5; border: 1px solid #ccebc5; }
.rel11term { background-color: #ffed6f; border: 1px solid #ffed6f; }
.rel12term { background-color: #a6cee3; border: 1px solid #a6cee3; }
.rel13term { background-color: #1f78b4; border: 1px solid #1f78b4; }
.rel14term { background-color: #b2df8a; border: 1px solid #b2df8a; }
.rel15term { background-color: #33a02c; border: 1px solid #33a02c; }
.rel16term { background-color: #fb9a99; border: 1px solid #fb9a99; }
.rel17term { background-color: #e31a1c; border: 1px solid #e31a1c; }
.rel18term { background-color: #fdbf6f; border: 1px solid #fdbf6f; }
.rel19term { background-color: #ff7f00; border: 1px solid #ff7f00; }

.rel20term { background-color: #cab2d6; border: 1px solid #cab2d6; }
.rel21term { background-color: #6a3d9a; border: 1px solid #6a3d9a; }
.rel22term { background-color: #ffff99; border: 1px solid #ffff99; }
.rel23term { background-color: #b15928; border: 1px solid #b15928; }
.rel24term { background-color: #fbb4ae; border: 1px solid #fbb4ae; }
.rel25term { background-color: #fbb4ae; border: 1px solid #fbb4ae; }
.rel26term { background-color: #ccebc5; border: 1px solid #ccebc5; }
.rel27term { background-color: #decbe4; border: 1px solid #decbe4; }
.rel28term { background-color: #fed9a6; border: 1px solid #fed9a6; }
.rel29term { background-color: #ffffcc; border: 1px solid #ffffcc; }

/* .invalid class prevents CSS from automatically applying */
.invalid input:required:invalid {
  background: #BE4C54;
}
 
/* Mark valid inputs during .invalid state */
.invalid input:required:valid {
  background: #17D654 ;
}

input {
  display: block;
  margin-bottom: 10px;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" ></script><script>;window.Modernizr=function(a,b,c){function z(){e.input=function(a){for(var b=0,c=a.length;b<c;b++)p[a[b]]=a[b]in k;return p}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "))}function y(a,b){return!!~(""+a).indexOf(b)}function x(a,b){return typeof a===b}function w(a,b){return v(m.join(a+";")+(b||""))}function v(a){j.cssText=a}var d="2.0.4",e={},f=b.documentElement,g=b.head||b.getElementsByTagName("head")[0],h="modernizr",i=b.createElement(h),j=i.style,k=b.createElement("input"),l=Object.prototype.toString,m=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),n={},o={},p={},q=[],r=function(a,c,d,e){var g,i,j,k=b.createElement("div");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:h+(d+1),k.appendChild(j);g=["&shy;","<style>",a,"</style>"].join(""),k.id=h,k.innerHTML+=g,f.appendChild(k),i=c(k,a),k.parentNode.removeChild(k);return!!i},s,t={}.hasOwnProperty,u;!x(t,c)&&!x(t.call,c)?u=function(a,b){return t.call(a,b)}:u=function(a,b){return b in a&&x(a.constructor.prototype[b],c)};for(var A in n)u(n,A)&&(s=A.toLowerCase(),e[s]=n[A](),q.push((e[s]?"":"no-")+s));e.input||z(),v(""),i=k=null,e._version=d,e._prefixes=m,e.testStyles=r;return e}(this,this.document);</script><script>
  (function($) {
    
    var helpers = {
      createLine: function(first, second, options){

        // use center of first and second term
        x1 = $(first).offset().left + $(first).width() / 2;
        y1 = $(first).offset().top + $(first).height() / 2;
        x2 = $(second).offset().left + $(second).width() / 2;
        y2 = $(second).offset().top + $(second).height() / 2;

        // if term spans more than one sentence:
        // use the center of the first word in the term
        if($(first).height() > 40) {
          x1 = $(first).first().find('.word').offset().left + $(first).find('.word').first().width() / 2;
          y1 = $(first).first().find('.word').offset().top + $(first).find('.word').first().height() / 2;
        }
        if($(second).height() > 40) {
          x2 = $(second).find('.word').first().offset().left + $(second).find('.word').first().width() / 2;
          y2 = $(second).find('.word').first().offset().top + $(second).find('.word').first().height() / 2;
        }
        
        // Check if browser is Internet Exploder ;)
        var isIE = navigator.userAgent.indexOf("MSIE") > -1;
        if (x2 < x1){
          var temp = x1;
          x1 = x2;
          x2 = temp;
          temp = y1;
          y1 = y2;
          y2 = temp;
        }
        var line = document.createElement("div");
        
        
        // Formula for the distance between two points
        // http://www.mathopenref.com/coorddist.html
        var length = Math.sqrt((x1-x2)*(x1-x2) + (y1-y2)*(y1-y2));
        
        line.style.width = length + "px";
        line.style.borderBottom = options.stroke + "px solid";
        line.style.borderColor = options.color;
        line.style.position = "absolute";
        line.style.zIndex = options.zindex;
        line.className = options.cls;
        

          var angle = Math.atan((y2-y1)/(x2-x1));
          line.style.top = y1 + 0.5*length*Math.sin(angle) + "px";
          line.style.left = x1 - 0.5*length*(1 - Math.cos(angle)) - (($('#mturk_form').width() - $('.container').width()) / 2) + 15 + "px";
          line.style.MozTransform = line.style.WebkitTransform = line.style.msTransform = line.style.OTransform= "rotate(" + angle + "rad)";
          
        return line;
      }
    }
        
        
        $.fn.line = function( x1, y1, x2, y2, options, callbacks) {
          return $(this).each(function(){
            if($.isFunction(options)){
              callback = options;
              options = null;
            }else{
              callback = callbacks;
            }
            options = $.extend({}, $.fn.line.defaults, options);
            
            $(this).append(helpers.createLine(x1,y1,x2,y2,options)).promise().done(function(){
              if($.isFunction(callback)){
                callback.call();
              }
            });
            
            
          });
        };
    $.fn.line.defaults = {  zindex : 10000,
                            color : '#000000',
                            stroke: "1",
                           };
  })(jQuery);
  

 
  // Preprocess
    
  
  // Array with available relation slots
  // Because all fields are hardcoded, they must be re-used.
   var relations = [];
    var relId = 0; // next unused slot
    for(i=0;i<30;i++) {
      relations.push(0);
    }
  var color = ['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462','#b3de69','#fccde5','#d9d9d9','#bc80bd'
               ,'#ccebc5','#ffed6f','#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00'
               ,'#cab2d6','#6a3d9a','#ffff99','#b15928','#fbb4ae','#b3cde3','#ccebc5','#decbe4','#fed9a6','#ffffcc'];
  


  // remove relation function
  $('.remove').click(function() {
    alignment =  $(this).parents('.alignment');
    var id = $(this).siblings('select').attr('name');
 
$(this).parent().hide( 600, function() {

$(this).children('select').prop('required',false);
$(this).children('select').prop('selectedIndex',0); // reset selection
    $('.relations .' + id + 'term').remove();

  });

    $('.lines .' + id + 'term').remove();
    $('.alignment .passage .' + id + 'term').replaceWith(function() {
      return $(this).contents();
    });

    $(alignment).find('.' + id + 'a').val("");
    $(alignment).find('.' + id + 'b').val("");
    
    // remove any partial selections to maintain color usage
    $(alignment).find('.selection').replaceWith(function() {
      return $(this).contents();
    });

   relations[id.substr(3)] = 0;
   relId = jQuery.inArray(0,relations); // get next unused relation slot
    redrawLines();
    
    // if less then 4 matches show notPossible field
    var relCount = 0;
    for(i in relations) {
      if(relations[i] == 1) {
        relCount++;
      }
    }
    if(relCount < 3) {
      $(alignment).find('.notPossible').show('slow');
$(alignment).find('.notPossible textarea').prop('required',true);
    }

  });

  // split passages
  $(".alignment .passage").each(function() {
    var words = $(this).text().split(" ");
    var passage = "";
    $.each(words, function(i, v) {
     passage += "<span class='word'>" + v + "</span>";
    });
    $(this).html(passage);
  });

  
  
  
  
  // Highlighting functions
  
  // highlight term
  function highlightTerm(passage, start) {
    var id = relId;
    if(!$(start).parents('.selection').length && id != -1) { // if no selection is made and maximum matches is not reached
      
      $(passage).children('.selection').contents().unwrap();
      start.wrapAll("<span class='term rel" + id + "term selection' />");

      $(passage).find('span:not(.selection)').bind('mouseover', function(e) {
        highlightMultiple(start, $(e.target), passage, id);
      });

    } else { // remove when click on selection
      $(passage).children('.selection').replaceWith(function() {
        return $(this).contents();
      });
    }
  }
  
  // highlight range of terms
  function highlightMultiple(start, end, passage, id) {
    // ignore margins between elements

    $(passage).find('.selection').contents().unwrap();
    if(start.is(end)) { // single element
      $(start).wrapAll("<span class='term rel" + id + "term selection'/>");
    } else { // if range of elements
      if($(passage).find('span').index(start) > $(passage).find('span').index(end)) { // swap if end is before start
        var temp = end;
        end = start;
        start = temp;
      }
      
      
      if(!start.parent().not($('.selection')).is(end.parent().not($('.selection')))) {
        // common parent element
        var common = end.parents().not($('.selection')).has(start).first();
        
        if(start.parent('.term').not(common).length) { // if word has a parent term
          start = $(common).children().has(start);
          // $(start).parent('.term');
        }
        
        if(end.parent('.term').not(common).length) {
          end = $(common).children().has(end);
          //end = $(end).parent('.term');
        }
      }
      // highlight range
      $(start).nextUntil(end.next()).andSelf().wrapAll("<span class='term rel" + id + "term selection' />");
    }
  }
  

  // update relation lines
  function redrawLines() {
     $('.lines').empty();
      for(i in relations) {
        if(relations[i] == 1) {
          $('.lines').line( $('.alignment').find('#passage1 .rel' + i + 'term'), $('.alignment').find('#passage2 .rel' + i + 'term'), {color: color[i], stroke:6, zindex:3, cls: 'rel' + i + 'term'});
        }
      }
  }
  
  // get word range index
  function selectionIndex(passage) {
    var selection = $(passage).find('.selection .word');
    var startId = $(passage).find('.word').index(selection.first());
    if(selection.length == 1) { // single word
      return startId;
    } else { // range of words
      return startId + "-" + (startId + selection.length - 1);
    } 
  }
  
  // finish selection and link terms
  function endSelection(alignment) {

    // add terms in relation selection
    $(alignment).find('.rel' + relId + 'a').val(selectionIndex($(alignment).find('#passage1')));
    $(alignment).find('.rel' + relId + 'b').val(selectionIndex($(alignment).find('#passage2')));
    $('.relations .rel' + relId + ' select').before('<span class=\'term rel' + relId + 'term\'>' + $(alignment).find('#passage1 .selection .word').not(":last").append(" ").end().text() + '</span>');
    $('.relations .rel' + relId + ' select').after('<span class=\'term rel' + relId + 'term\'>' + $(alignment).find('#passage2 .selection .word').not(":last").append(" ").end().text() + '</span>');
$('.relations .rel' + relId + ' select').prop('required',true);
    $('.relations .rel' + relId).show('slow');
    
    // remove selection ids
    $('.selection').removeClass('selection');

    // set relation slot as occupied; find next slot;
    relations[relId] = 1;
    relId = jQuery.inArray(0,relations);  // next unused slot
    redrawLines();

    // if more then three relation exists, hide explanation field
    var relCount = 0;
    for(i in relations) {
      if(relations[i] == 1) {
        relCount++;
      }
      if(relCount > 2) {
        $(alignment).find('.notPossible').hide('slow');
$(alignment).find('.notPossible textarea').prop('required',false);
        break;
      }
    }
  }
    
  // highlighting triggers
  $(".alignment .passage span:not(.selection)").mousedown(function(e) {
    highlightTerm($(this).parents('.passage'), $(e.target));
  }).mouseup(function() {
    $('span').unbind('mouseover');
    if($(this).parents('.alignment').find('#passage1 .selection').length && $(this).parents('.alignment').find('#passage2 .selection').length) {
      endSelection($(this).parents('.alignment'));
    }
  });

$( window ).resize(function() {
redrawLines();
});

$('#browser').val(navigator.userAgent);

if (!Modernizr.input.required) {
$('#mturk_form').submit(function(e) {
if($("#mturk_form .relation:not(:hidden) select option[value='']:selected").length > 0) {
      e.preventDefault();
} else {
if($("#mturk_form .relation:not(:hidden)").length < 3 && $('.notpossible textarea').val().length < 10) {
      e.preventDefault();
}
}
});
}
</script>