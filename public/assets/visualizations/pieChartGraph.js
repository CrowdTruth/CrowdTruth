function pieChartGraph(tooltip,matchStr,groupID,chartName,divName,nrPieCharts){this.url="/api/analytics/piegraph/?";this.matchStr=matchStr;this.groupID=groupID;this.chartName=chartName;var colors=Highcharts.getOptions().colors,colorMaps={},pieChart="",renderTo=divName+"_div",drawPieChart=function(chartData){pieChart=new Highcharts.Chart({chart:{renderTo:renderTo,type:'pie',width:(($('.maincolumn').width()-50)/nrPieCharts),height:200,events:{load:function(){var chart=this,legend=chart.legend;for(var i=0,len=legend.allItems.length;i<len;i++){var item=legend.allItems[i].legendItem,prefix="";if(tooltip.prefix!='')prefix=tooltip.prefix+' ';var suffix="";if(tooltip.suffix!='')suffix=' '+tooltip.suffix;var tooltipValue='Number of '+tooltip.label+' '+prefix+legend.allItems[i].name+suffix+'.Click to select/deselect.';item.attr("data-toggle","tooltip");item.attr("title",tooltipValue)}}}},title:{text:chartName},credits:{enabled:false},tooltip:{useHTML:true,formatter:function(){var prefix="";if(tooltip.prefix!='')prefix=tooltip.prefix+' ';var suffix="";if(tooltip.suffix!='')suffix=' '+tooltip.suffix;return'<p><b>'+this.key+': </b>'+this.percentage.toFixed(2)+' % </br>('+tooltip.label+' '+prefix+this.key+suffix+': '+this.y+'/'+this.total+')</p>'},followPointer:false,hideDelay:10},legend:{maxHeight:50},yAxis:[{scalable:false}],plotOptions:{pie:{dataLabels:{enabled:false},showInLegend:true}},series:[{type:'pie',name:chartName,hasCustomFlag:34,data:chartData}]})};this.drawPieChart=drawPieChart;this.createPieChart=function(matchStr){if(matchStr=="")matchStr=this.matchStr;$.getJSON(this.url+matchStr+'&group='+groupID,function(data){var chartData=[];for(var indexData in data){var name=data[indexData]['_id']+'',color="";if(name in colorMaps){color=colorMaps[name]}else{color=colors[indexData%(colors.length)];colorMaps[name]=color};chartData.push({name:name,y:data[indexData]['count'],color:color})};return drawPieChart(chartData)})};this.update=function(matchStr){}};;